# map-polygon-editor

地図上のポリゴン編集に特化した**データ管理ライブラリ**。

エリアの階層管理・ジオメトリ演算・undo/redo・ストレージ抽象化を担う。
地図の描画・入力処理はアプリ側に委譲する設計で、Google Maps・Leaflet・flutter_map など任意の地図ライブラリと組み合わせて使用できる。

## 主なユースケース

- 地域の個別訪問（ドアノック営業、布教活動など）
- チラシ配り・営業エリア管理
- ボランティア担当エリアの割り振り

人が地域をエリア分けして管理するシナリオを主眼に置く。

## 主な機能

- **ポリゴン描画・編集**：頂点の追加・移動・削除、切断線による分割
- **エリア階層管理**：国→都道府県→市区町村などの親子階層、Union による親形状の自動導出
- **共有境界の連動編集**：隣接エリアの境界頂点を同時更新
- **Undo / Redo**：ドラフト内・コミット済みの2レイヤー
- **ストレージ抽象化**：`StorageAdapter` インターフェースによる永続化層の委譲

## ドキュメント

| ドキュメント | 内容 |
|------------|------|
| [概要](docs/overview.md) | プロジェクト概要・技術選定 |
| [エリアレベル仕様](docs/polygon-area-levels.md) | エリア階層・データ設計・親子関係・親ポリゴン導出ルール |
| [ポリゴン編集 API](docs/polygon-editing-api.md) | 全 API 仕様・操作パターン・Undo/Redo・ストレージ抽象化 |

## アーキテクチャ

このライブラリは地図描画を行わない。GeoJSON の入出力インターフェースを通じて任意の地図ライブラリと連携する。

```
┌─────────────────────────────────┐
│        map-polygon-editor        │
│                                  │
│  Area管理 / undo/redo / storage  │
│  geometry演算 / 共有境界連動     │
└──────────────┬───────────────────┘
               │ GeoJSON の入出力のみ
   ┌───────────┼────────────┐
   ↓           ↓            ↓
Terra Draw  flutter_map  Google Maps
（Web）      （Flutter）  （JS/Flutter）
```

## ステータス

仕様策定中。実装はまだ開始していない。
